<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>BRLTTY: The Build Procedure</TITLE>
 <LINK HREF="Manual-3.html" REL=next>
 <LINK HREF="Manual-1.html" REL=previous>
 <LINK HREF="Manual.html#toc2" REL=contents>
</HEAD>
<BODY>
<A HREF="Manual-3.html">Next</A>
<A HREF="Manual-1.html">Previous</A>
<A HREF="Manual.html#toc2">Contents</A>
<HR>
<H2><A NAME="s2">2. The Build Procedure</A></H2>

<P>BRLTTY can be downloaded from its web site
(see section 
<A HREF="Manual-8.html#contact">Contact Information</A> for its location).
All releases are provided as compressed 
<A HREF="#tar">tar balls</A>.
Newer releases are also provided as 
<A HREF="#rpm">RPM</A> (RedHat Package Manager) files.
<P>That tidbit of information has probably peaked your curiosity,
and now you just can't wait to get started.
It's a good idea, though,
to first become familiar with the files which will ultimately be installed.
<P>
<H2><A NAME="hierarchy"></A> <A NAME="ss2.1">2.1 Installed File Hierarchy</A>
</H2>

<P>The build procedure should result in the installation of the following files:
<DL>
<DT><B>/sbin/</B><DD><P>
<DL>
<DT><B>brltty</B><DD><P>The BRLTTY program.
<DT><B>install-brltty</B><DD><P>A 
<A HREF="#utility-install-brltty">utility</A> for copying BRLTTY's
<A HREF="#hierarchy">installed file hierarchy</A>
from one location to another.
</DL>
<DT><B>/etc/brltty/</B><DD><P>Your installation of BRLTTY may not have all of the following types of files.
They're only created as needed based on your customization of the make file
(see 
<A HREF="#make-customize">Make File Customization</A>).
<DL>
<DT><B>*.conf</B><DD><P>Driver-specific configuration data.
Their names look more or less like <CODE>brltty-</CODE><EM>driver</EM><CODE>.conf</CODE>,
where <EM>driver</EM> is the two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>.
<DT><B>*.ctb</B><DD><P>Contraction tables
(see section 
<A HREF="Manual-5.html#contraction">Contraction Tables</A> for details).
Their names look like <EM>language</EM><CODE>-</CODE><EM>country</EM><CODE>-</CODE><EM>level</EM><CODE>.ctb</CODE>.
<DT><B>*.hlp</B><DD><P>Driver-specific help pages.
Their names look more or less like <CODE>brltty-</CODE><EM>driver</EM><CODE>.hlp</CODE>,
where <EM>driver</EM> is the two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>.
<DT><B>*.tbl</B><DD><P>Translation tables
(see section 
<A HREF="Manual-4.html#translation">Translation Tables</A> for details).
Their names look like <CODE>text.</CODE><EM>language</EM><CODE>.tbl</CODE>.
Tables designed for use with character sets other than <CODE>iso-8859-1</CODE>
have names which indicate this fact.
There are also a couple of special tables which map
character highlighting attributes to braille dots:
<CODE>attrib.tbl</CODE> does it the original way,
and <CODE>attributes.tbl</CODE> does it the current way.
</DL>
<DT><B>/lib/brltty/</B><DD><P>Your installation of BRLTTY may not have all of the following types of files.
They're only created as needed based on your customization of the make file
(see 
<A HREF="#make-customize">Make File Customization</A>).
<DL>
<DT><B>brltty-brl.lst</B><DD><P>A list of the braille display drivers which have been built
as dynamically loadable shared objects,
and, therefore, which can be selected at run time.
Each line consists of
the two-letter identification code for a driver,
a tab character,
and a description of the braille display which that driver is for.
<DT><B>libbrlttyb<EM>driver</EM>.so.1</B><DD><P>The dynamically loadable driver for a braille display,
where <EM>driver</EM> is the two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>.
<DT><B>brltty-spk.lst</B><DD><P>A list of the speech synthesizer drivers which have been built
as dynamically loadable shared objects,
and, therefore, which can be selected at run time.
Each line consists of
the two-letter identification code for a driver,
a tab character,
and a description of the speech synthesizer which that driver is for.
<DT><B>libbrlttys<EM>driver</EM>.so.1</B><DD><P>The dynamically loadable driver for a speech synthesizer,
where <EM>driver</EM> is the two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>.
</DL>
</DL>
<P>Some optional files which you should be aware of,
although they aren't part of the installed file hierarchy, are:
<DL>
<DT><B>/etc/brltty.conf</B><DD><P>The system defaults configuration file.
It's created by the system administrator.
See 
<A HREF="Manual-3.html#configure">The Configuration File</A> for details.
<DT><B>/etc/brltty-<EM>driver</EM>.prefs</B><DD><P>The saved preferences settings file
(<EM>driver</EM> is a two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>).
It's created by the 
<A HREF="Manual-3.html#command-PREFSAVE">PREFSAVE</A> command.
See 
<A HREF="Manual-3.html#preferences">Preferences Settings</A> for details.
</DL>
<P>
<H2><A NAME="rpm"></A> <A NAME="ss2.2">2.2 Installing from an RPM File</A>
</H2>

<P>To install BRLTTY from an RPM (RedHat Package Manager) file, do the following:
<OL>
<LI>Download the binary package which corresponds to your hardware.
It'll be a file named
<CODE>brltty-</CODE><EM>release</EM><CODE>-</CODE><EM>version</EM><CODE>.</CODE><EM>architecture</EM><CODE>.rpm</CODE>,
e.g. <CODE>brltty-3.0-1.i386.rpm</CODE>.</LI>
<LI>Install the package.
<BLOCKQUOTE><CODE>
rpm -Uvh brltty-<EM>release</EM>-<EM>version</EM>.<EM>architecture</EM>.rpm
</CODE></BLOCKQUOTE>

This should be done as <B>root</B>.
Strictly speaking, the <CODE>-U</CODE> (update) option is the only one which is necessary.
The <CODE>-v</CODE> (verbose) option displays the name of the package as it's being installed.
The <CODE>-h</CODE> (hashes) option displays a progress meter (using hash signs).</LI>
</OL>

For the brave,
we also provide the source RPM (<CODE>.src.rpm</CODE>) file,
but that's beyond the scope of this document.
<P>To uninstall BRLTTY, do:
<BLOCKQUOTE><CODE>
rpm -e brltty
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="tar"></A> <A NAME="ss2.3">2.3 Installing from a TAR Ball</A>
</H2>

<P>Here's what to do if you just want to install BRLTTY as quickly as possible,
trusting that all of our defaults are correct.
<OL>
<LI>Download the source.
It'll be a file named
<CODE>brltty-</CODE><EM>release</EM><CODE>.tar.gz</CODE>,
e.g. <CODE>brltty-3.0.tar.gz</CODE>.</LI>
<LI>Unpack the source into its native hierarchical structure.
<BLOCKQUOTE><CODE>
tar xzf brltty-<EM>release</EM>.tar.gz
</CODE></BLOCKQUOTE>

This should create the directory <CODE>brltty-</CODE><EM>release</EM>.</LI>
<LI>Change to the source directory, and compile and install BRLTTY.
<BLOCKQUOTE><CODE>
cd brltty-<EM>release</EM><BR>
make install
</CODE></BLOCKQUOTE>

This should be done as <B>root</B>.</LI>
</OL>
<P>To uninstall BRLTTY, do:
<BLOCKQUOTE><CODE>
cd brltty-<EM>release</EM><BR>
make uninstall
</CODE></BLOCKQUOTE>
<P>That's all there's to it.
Now, for those who really want to know what's going on, here are the details.
<P>
<H3><A NAME="make-customize"></A> Make File Customization</H3>

<P>Before compiling BRLTTY, you should check to see if it requires
any special configuration for your system and/or your needs.  
To do this,
read the comments at the top of the file <CODE>Makefile</CODE> in the top-level directory,
and, following the instructions contained therein, make any needed changes.
Then read the <CODE>README</CODE> file in the subdirectory
containing the driver for your braille display
to check for any additional display-specific instructions.
We've tried to make the defaults fit the most common case, so,
assuming that you're not attempting to do anything out of the ordinary,
you may not need to make any changes at all.
<P>The variables within the make file which you may wish to set and/or alter include:
<DL>
<DT><B>BRL_TARGET
<A NAME="make-braille-driver"></A> </B><DD><P>There's one commented out assignment to this variable
for each supported braille display.
If you don't uncomment any of them,
then all of the braille display drivers are built
as dynamically loadable shared objects,
and the needed one can be selected at run time.
If you do uncomment one of them,
then ohly that driver is compiled,
and statically linked into the BRLTTY binary.
Don't uncomment more than one of them.
<DT><B>BRLDEV
<A NAME="make-braille-device"></A> </B><DD><P>This variable specifies the path to the special file
for the device to which the braille display is connected.
It's initially set to <CODE>/dev/ttyS0</CODE> (the primary serial port).
<DT><B>SPK_TARGET
<A NAME="make-speech-driver"></A> </B><DD><P>There's one commented out assignment to this variable
for each supported speech synthesizer.
If you don't uncomment any of them,
then all of the speech synthesizer drivers are built
as dynamically loadable shared objects,
and the needed one can be selected at run time.
If you do uncomment one of them,
then ohly that driver is compiled,
and statically linked into the BRLTTY binary.
Don't uncomment more than one of them.
<DT><B>TEXTTRANS
<A NAME="make-tables-text"></A> </B><DD><P>There's one commented out assignment to this variable
for each provided text translation table.
If you don't uncomment any of them,
then a commonly (in North America) used 8-dot variant of the
<A HREF="Manual-7.html#nabcc">North American Braille Computer Code</A>
is assumed.
Don't uncomment more than one of them.
This specification only establishes a default text translation table;
the needed one can always be selected at run time.
<DT><B>ATTRTRANS
<A NAME="make-tables-attributes"></A> </B><DD><P>This variable specifies the attributes translation table which is to be used.
It's initially set to <CODE>attributes.tbl</CODE>.
Change it to <CODE>attrib.tbl</CODE> if you'd like it done the old way.
This specification only establishes a default attributes translation table;
the needed one can always be selected at run time.
<DT><B>INSTALL_ROOT
<A NAME="make-install-root"></A> </B><DD><P>Set this variable if you need to install BRLTTY in a different location
than the one from which it'll ultimately be used.
You need to use this feature, for example,
if you're building BRLTTY on one system for use on another.
If this variable is set, then the installed file hierarchy
is anchored at the directory which it specifies.
If it isn't set, then the installed file hierarchy
is anchored at the system's root directory.
It only applies to <CODE>make install</CODE> and <CODE>make uninstall</CODE>.
<DT><B>PREFIX
<A NAME="make-install-prefix"></A> </B><DD><P>Set this variable if you need to install
BRLTTY's run-time files in a non-standard location.
You need to use this feature, for example, if you'd like to have
more than one release of BRLTTY installed at the same time.
If this variable is set, then the installed file hierarchy
is anchored at the directory which it specifies.
If it isn't set, then the installed file hierarchy
is anchored at the system's root directory.
Even though its sole purpose is to determine
where the run-time files are to be installed,
it must be set (or not set) throughout the whole build process since
certain components of BRLTTY need to know exactly where to find others.
<DT><B>PROG_DIR
<A NAME="make-install-program"></A> </B><DD><P>This variable specifies the directory
into which the binaries are installed.
It's initially set to <CODE>/sbin</CODE>.
<DT><B>DATA_DIR
<A NAME="make-install-data"></A> </B><DD><P>This variable specifies the directory
into which the tables, help pages, and other data files are installed.
It's initially set to <CODE>/etc/brltty</CODE>.
<DT><B>LIB_DIR
<A NAME="make-install-library"></A> </B><DD><P>This variable specifies the directory
into which the drivers and other architecture-dependent files are installed.
It's initially set to <CODE>/lib/brltty</CODE>.
<DT><B>INSTALL_USER
<A NAME="make-install-user"></A> </B><DD><P>This variable specifies the user which is to own
the binaries and the drivers.
It's initially set to <CODE>root</CODE>.
<DT><B>INSTALL_GRUOP
<A NAME="make-install-group"></A> </B><DD><P>This variable specifies the group which is to own
the binaries and the drivers.
It's initially set to <CODE>root</CODE>.
<DT><B>INSTALL_MODE
<A NAME="make-install-mode"></A> </B><DD><P>This variable specifies the file permissions for
the binaries and the drivers.
It's initially set to <CODE>744</CODE>
(see the man page for <CODE>chmod(1)</CODE>).
<DT><B>SCR_O
<A NAME="make-screen-driver"></A> </B><DD><P>This variable specifies which screen driver is to be used.
It's initially set to <CODE>scr_linux.o</CODE>.
Another screen driver, <CODE>scr_shm.o</CODE>, may also be used
in conjunction with the patch we provide for the <CODE>screen</CODE> program
(see the <CODE>Patches</CODE> subdirectory).
<DT><B>VCSADEV
<A NAME="make-screen-device"></A> </B><DD><P>This variable tells the Linux screen driver
what all the possible paths to the screen content inspection device are.
It's initially set to <CODE>/dev/vcsa /dev/vcsa0 /dev/vcc/a</CODE>.
<DT><B>CROSSCOMP
<A NAME="make-compile-cross"></A> </B><DD><P>Set this variable if you're cross-compiling for a different architecture.
This feature assumes that all of the commands within
the cross-compile suite for that architecrue have the same prefix,
and this variable should be set to that common prefix.
</DL>
<P>
<H3>Make File Targets</H3>

<P>BRLTTY's make file supports most of the common application maintenance targets.
They include:
<DL>
<DT><B>make</B><DD><P>A shortcut for <CODE>make all</CODE>.
<DT><B>make all</B><DD><P>Compile and link the BRLTTY executable, its drivers and their help pages,
its test programs, and a few other small utilities.
<DT><B>make install</B><DD><P>Complete the compile and link phase (see <CODE>make all</CODE>), and then install
the BRLTTY executable, its data files, drivers, and help pages,
in the correct places and with the correct permissions.
The screen content inspection device (<CODE>/dev/vcsa</CODE> or equivalent)
is created if it doesn't already exist.
<DT><B>make uninstall</B><DD><P>Remove the BRLTTY executable, its data files, drivers, and help pages,
from the system.
<DT><B>make clean</B><DD><P>Ensure that the next compile and link (see <CODE>make all</CODE>)
will be done from scratch by removing the results of
compiling, linking, and testing from the source directory structure.
This includes the removal of object files, executables,
dynamically loadable shared objects, driver lists, help pages,
temporary header files, and core files.
<DT><B>make distclean</B><DD><P>In addition to removing the results of a build (see <CODE>make clean</CODE>),
also remove other files from the source directory structure
which tend to accumulate over time but which don't belong there.
This includes the removal of editor backup files, test case results,
rejected patch hunks, and copies of original source files.
</DL>
<P>
<H2><A NAME="ss2.4">2.4 Testing BRLTTY</A>
</H2>

<P>After compiling, linking, and installing BRLTTY,
it's a good idea to give it a quick test before activating it permanently.
To do so, invoke it with the command:
<BLOCKQUOTE><CODE>
brltty -b<EM>driver</EM> -d<EM>device</EM>
</CODE></BLOCKQUOTE>

For <EM>driver</EM>, specify the two-letter
<A HREF="Manual-7.html#drivers">driver identification code</A>
corresponding to your braille display.
For <EM>device</EM>, specify the full path
for the device to which your braille display is connected.
<P>If you don't want to explicitly identify the driver and device
each time you start BRLTTY, then you can take two approaches.
You can establish system defaults
via the 
<A HREF="Manual-3.html#configure-braille-driver">braille-driver</A>
and the 
<A HREF="Manual-3.html#configure-braille-device">braille-device</A>
configuration file directives,
and/or compile your needs right into BRLTTY
via the 
<A HREF="#make-braille-driver">BRL_TARGET</A>
and the 
<A HREF="#make-braille-device">BRLDEV</A>
make file variables.
<P>If all is well, BRLTTY's version identification message
should appear on the braille display for a few seconds
(see the 
<A HREF="Manual-3.html#options-message-delay">-M</A> command line option).
After it goes away (which you can hasten by pressing any key on the display),
the area of the screen where the cursor is should appear.
This means that you should expect to see your shell's command prompt.
Then, as you enter your next command,
each character should appear on the display as it's typed on the keyboard.
<P>If this is your experience, then leave BRLTTY running, and enjoy it.
If this isn't your experience, then it may be necessary
to test each driver separately in order to isolate the source of the probledm.
The screen driver can be tested with 
<A HREF="#utility-scrtest">scrtest</A>,
and the braille display driver can be tested with 
<A HREF="#utility-brltest">brltest</A>.
<P>If you experience a problem which requires a lot of digging,
then you may wish to use the following <CODE>brltty</CODE> command line options:
<UL>
<LI>
<A HREF="Manual-3.html#options-log-level">-ldebug</A>
to log lots of diagnostic messages.</LI>
<LI>
<A HREF="Manual-3.html#options-no-daemon">-n</A>
to keep BRLTTY in the foreground.</LI>
<LI>
<A HREF="Manual-3.html#options-standard-error">-e</A>
to direct diagnostic messages to standard error
rather than to the system log.</LI>
</UL>
<P>
<H2><A NAME="ss2.5">2.5 Starting BRLTTY</A>
</H2>

<P>BRLTTY, when properly installed, is invoked with the single command <CODE>brltty</CODE>.
A configuration file
(see section 
<A HREF="Manual-3.html#configure">The Configuration File</A> for details)
can be created in order to establish system defaults for such things as
the location of the preferences file,
the braille display driver to be used,
the device to which the braille display is connected,
and the text translation table to be used.
Many options
(see section 
<A HREF="Manual-3.html#options">Command Line Options</A> for details)
allow explicit run-time specification of such things as
the location of the configuration file,
any defaults established within the configuration file,
and some characteristics which have reasonable defaults
but which those who think they know what they're doing may wish to play with.
The 
<A HREF="Manual-3.html#options-help">-h</A> option
displays a summary of all the options.
The 
<A HREF="Manual-3.html#options-version">-v</A> option
displays the current version of the program and the selected drivers.
<P>It's probably best to have the system automatically start BRLTTY
as part of the boot sequence
so that the braille display is already up and running when the login prompt appears.
Most (probably all) distributions provide a script wherein
user-supplied applications can be safely started near the end of the boot sequence.
The name of this script is distribution-dependent.
Here are the ones we know about so far:
<DL>
<DT><B>Red Hat</B><DD><P><CODE>/etc/rc.d/rc.local</CODE>
</DL>
<P>Starting BRLTTY from this script is a good approach (especially for new users).
Just add a set of lines like these:
<BLOCKQUOTE><CODE>
<PRE>
if [ -x /sbin/brltty ]
then
   /sbin/brltty
fi
</PRE>
</CODE></BLOCKQUOTE>

This can usually be abbreviated to the somewhat less readable form:
<BLOCKQUOTE><CODE>
<PRE>
[ -x /sbin/brltty ] &amp;&amp; /sbin/brltty
</PRE>
</CODE></BLOCKQUOTE>

Don't add these lines before the first line
(which usually looks like <CODE>#!/bin/sh</CODE>).
<P>If the braille display is to be used by a system administrator,
then it should probably be started as early as possible during the boot sequence
(like before the file systems are checked)
so that the display is usable
in the event that something goes wrong during these checks
and the system drops into single user mode.
Again, exactly where it's best to do this is distribution-dependent.
Here are the places we know about so far:
<DL>
<DT><B>Debian</B><DD><P><CODE>/etc/init.d/boot</CODE> for older releases,
and <CODE>/etc/init.d/rcS</CODE> for newer releases.
<DT><B>RedHat</B><DD><P><CODE>/etc/rc.d/rc.sysinit</CODE>
Beware that later releases,
in order to support a more user-oriented system initialization procedure,
have this script reinvoke itself such that
it's under the control of <CODE>initlog</CODE>.
Look, probably right up near the top, for a set of lines like these:
<BLOCKQUOTE><CODE>
<PRE>
    # Rerun ourselves through initlog
    if [ -z "$IN_INITLOG" ]; then
     [ -f /sbin/initlog ] &amp;&amp; exec /sbin/initlog $INITLOG_ARGS -r /etc/rc.sysinit
    fi
    
</PRE>
</CODE></BLOCKQUOTE>

Starting BRLTTY before this reinvocation
results in two BRLTTY processes running at the same time,
and that'll give you no end of problems.
If your version of this script has this feature,
then make sure you start BRLTTY after the lines which implement it.
<DT><B>Slackware</B><DD><P><CODE>/etc/rc.d/rc.S</CODE>
<DT><B>SuSE</B><DD><P><CODE>/sbin/init.d/boot</CODE>
</DL>
<P>An alternative is to start BRLTTY from <CODE>/etc/inittab</CODE>.
You have two choices if you choose this route.
<UL>
<LI>If you want it to be started really early
but don't need it to be automatially restarted if it dies,
then add a line like this before the first <CODE>:sysinit:</CODE> line which is already in there.
<BLOCKQUOTE><CODE>
bt::sysinit:/sbin/brltty
</CODE></BLOCKQUOTE>
</LI>
<LI>If you don't mind it being started later
but do want it to be automatially restarted if it dies,
then add a line like this anywhere within the file.
<BLOCKQUOTE><CODE>
bt:12345:respawn:/sbin/brltty -n
</CODE></BLOCKQUOTE>

The 
<A HREF="Manual-3.html#options-no-daemon">-n</A> (<CODE>--nodaemon</CODE>) option is very
important when running BRLTTY with <B>init</B>'s <CODE>respawn</CODE> facility.
You'll end up with hundreds of BRLTTY processes all running at the same time
if you forget to specify it.</LI>
</UL>

Check that the identifier (<CODE>bt</CODE> in these examples)
isn't already being used by another entry,
and, if it is, choose a different one which isn't.
<P>Note that a command like <CODE>kill -TERM</CODE>
is sufficient to stop BRLTTY in its tracks.
If it dies during entry into single user mode, for example,
it may well be due to a problem of this nature.
<P>Some systems experience problems if an application tries to use
the kernel's sound subsystem before it has been initialized.
If your system is one of them, then
you may need to disable the automatic starting of the speech synthesizer driver
with the 
<A HREF="Manual-3.html#options-no-speech">-N</A> option.
<P>Some systems, as part of the boot sequence, probe the serial ports
(usually in order to automatically find the mouse and deduce its type).
If your braille display is using a serial port,
this kind of probing may be enough to get it confused.
If this happens to you, then try restarting the braille driver
(see the 
<A HREF="Manual-3.html#command-RESTARTBRL">RESTARTBRL</A> command).
Better yet, turn off the serial port probing.
Here's what we know so far about how to do this:
<DL>
<DT><B>Red Hat</B><DD><P>The probing is done by a service named <CODE>kudzu</CODE>.
Use the command 
<BLOCKQUOTE><CODE>
chkconfig --list kudzu
</CODE></BLOCKQUOTE>
 to see if it's been enabled.
Use the command 
<BLOCKQUOTE><CODE>
chkconfig kudzu off
</CODE></BLOCKQUOTE>
 to disable it.
Later releases allow you to let <CODE>kudzu</CODE> run
without probing the serial ports.
To do this, edit the file <CODE>/etc/sysconfig/kudzu</CODE>,
and set <CODE>SAFE</CODE> to <CODE>yes</CODE>.
</DL>
<P>If you want to start BRLTTY before any file systems are mounted, then
ensure that all of its components are installed within the root file system.
See the 
<A HREF="#make-install-prefix">PREFIX</A>,
<A HREF="#make-install-program">PROG_DIR</A>,
<A HREF="#make-install-data">DATA_DIR</A>,
<A HREF="#make-install-library">LIB_DIR</A>,
and 
<A HREF="#make-screen-device">VCSADEV</A> make file variables.
<P>
<H2><A NAME="ss2.6">2.6 Security Considerations</A>
</H2>

<P>BRLTTY needs to run with root privileges because it needs
read and write access for the port to which the braille display is connected,
read access to <CODE>/dev/vcsa</CODE> or equivalent
(to query the screen dimensions and the cursor position,
and to review the current screen content and highlighting),
and read and write accesws to the system console
(for arrow key entry during cursor routing,
for input character insertion during paste,
for special key simulation using keys on the braille display,
for retrieving output character translation and screen font mapping tables,
and for making the computer's speaker beep).
Access to the needed devices can, of course, be granted to a non-root user
by changing the file permissions associated with the devices.
Merely having access to the console, however, isn't enough because
making the speaker beep and simulating key strokes still require root privilege.
So, if you're willing to give up cursor routing, cut&amp;paste, beeps,
and all that, you can run BRLTTY without root priviledge.
<P>
<H2><A NAME="ss2.7">2.7 Other Utilities</A>
</H2>

<P>Building BRLTTY also results in the building of
a few small helper and diagnostic utilities.
<P>
<H3><A NAME="utility-install-brltty"></A> install-brltty</H3>

<P>This utility copies BRLTTY's
<A HREF="#hierarchy">installed file hierarchy</A>
from one location to another.
<BLOCKQUOTE><CODE>
install-brltty <EM>to</EM> [<EM>from</EM>]
</CODE></BLOCKQUOTE>

<DL>
<DT><B><EM>to</EM></B><DD><P>The location to which the
<A HREF="#hierarchy">installed file hierarchy</A>
is to be copied.
It must be an existing directory.
<DT><B><EM>from</EM></B><DD><P>The location from which the
<A HREF="#hierarchy">installed file hierarchy</A>
is to be taken.
If it's specified, then it must be an existing directory.
If it's not specified, then the location used for the build is assumed.
</DL>
<P>The screen content inspection device is also created
(if it doesn't already exist)
within the <EM>to</EM> hierarchy.
<P>This utility can be used, for example, to copy BRLTTY to a root disk.
If a root floppy is mounted as <CODE>/mnt</CODE>,
and BRLTTY is installed on the main system,
then typing 
<BLOCKQUOTE><CODE>
install-brltty /mnt
</CODE></BLOCKQUOTE>

copies BRLTTY, along with all of its data and library files,
to the root floppy.
<P>Some problems have been experienced when copying BRLTTY
between systems with different versions of the shared C library.
This is worth investigating if you have difficulties.
<P>
<H3>txt2hlp</H3>

<P>This is a helper utility which is used during the build procedure
to prepare the help pages for the drivers.
<BLOCKQUOTE><CODE>
txt2hlp <EM>output-file</EM> <EM>input-file</EM> ...
</CODE></BLOCKQUOTE>

<DL>
<DT><B><EM>output-file</EM></B><DD><P>The file which is to contain all of the compiled help pages.
The pages are numbered, starting from zero,
in the same order as the input files are specified.
<DT><B><EM>input-file</EM></B><DD><P>At least one input file must be specified.
Each is the source for a single help page,
and should contain plain text.
</DL>
<P>
<H3>tbl2hex</H3>

<P>This is a helper utility which is used during the build procedure
to prepare the default text and attributes translation tables.
<BLOCKQUOTE><CODE>
tbl2hex
</CODE></BLOCKQUOTE>

The translation table is read from standard input,
and a set of hexadecimal constants
suitable for inclusion within a C array initializer
is written to standard output.
<P>
<H3><A NAME="utility-brltest"></A> brltest</H3>

<P>This utility tests the braille display driver,
and also provides an interactive way to learn
what the keys on the braille display do.
It must be run as root.
<BLOCKQUOTE><CODE>
brltest -<EM>option</EM> ... [<EM>driver</EM> [<EM>name</EM>=<EM>value</EM>] ...]
</CODE></BLOCKQUOTE>

<DL>
<DT><B><EM>driver</EM></B><DD><P>The driver for the braille display.
It may be
either a two-letter 
<A HREF="Manual-7.html#drivers">driver identification code</A>
or the absolute path to a dynamically loadable shared object.
If it's not specified, then the driver configured within the
<A HREF="#make-braille-driver">make file</A> is assumed.
<DT><B><EM>name</EM><CODE>=</CODE><EM>value</EM></B><DD><P>Set a braille display driver parameter.
For a description of the parameters accepted by a specific driver,
please see the documentation for that driver.
<DT><B><CODE>-d</CODE><EM>device</EM> <CODE>--device=</CODE><EM>device</EM></B><DD><P>The absolute path for the device to which the braille display is connected.
If it's not specified, then the device configured within the
<A HREF="#make-braille-device">make file</A> is assumed.
</DL>
<P>This utility uses BRLTTY's 
<A HREF="Manual-3.html#learn">Command Learn Mode</A>.
The key press timeout
(after which this utility exits)
is <CODE>10</CODE> seconds.
The message hold time
(used for non-final segments of long messages)
is <CODE>4</CODE> seconds.
<P>
<H3><A NAME="utility-scrtest"></A> scrtest</H3>

<P>This utility tests the screen driver.
It must be run as root.
<BLOCKQUOTE><CODE>
scrtest -<EM>option</EM> ...
</CODE></BLOCKQUOTE>

<DL>
<DT><B><CODE>-c</CODE><EM>column</EM> <CODE>--column=</CODE><EM>column</EM></B><DD><P>Specify the starting (left) column (zero-origin) of the region.
If this value isn't supplied,
then a default value, based on the specified width,
is selected such that the region is horizontally centred.
<DT><B><CODE>-h</CODE><EM>rows</EM> <CODE>--height=</CODE><EM>rows</EM></B><DD><P>Specify the height of the region (in rows).
If this value isn't supplied,
then a default value, based on the specified starting row,
is selected such that the region is vertically centred.
<DT><B><CODE>-p</CODE><EM>name</EM><CODE>=</CODE><EM>value</EM> <CODE>--parameter=</CODE><EM>name</EM><CODE>=</CODE><EM>value</EM></B><DD><P>Set a screen driver parameter.
For a description of the parameters accepted by a specific driver,
please see the documentation for that driver.
<DT><B><CODE>-r</CODE><EM>row</EM> <CODE>--row=</CODE><EM>row</EM></B><DD><P>Specify the starting (top) row (zero-origin) of the region.
If this value isn't supplied,
then a default value, based on the specified height,
is selected such that the region is vertically centred.
<DT><B><CODE>-w</CODE><EM>columns</EM> <CODE>--width=</CODE><EM>columns</EM></B><DD><P>Specify the width of the region (in columns).
If this value isn't supplied,
then a default value, based on the specified starting column,
is selected such that the region is horizontally centred.
</DL>
<P>Notes:
<UL>
<LI>If neither a starting column nor a region width is specified,
then the region is horizontally-centred and starts at column 5.</LI>
<LI>If neither a starting row nor a region height is specified,
then the region is vertically-centred and starts at row 5.</LI>
</UL>
<P>The following is written to standard output:
<OL>
<LI>A line detailing the dimensions of the screen.
<BLOCKQUOTE><CODE>
Screen: <EM>width</EM>x<EM>height</EM>
</CODE></BLOCKQUOTE>
</LI>
<LI>A line detailing the position (zero-origin) of the cursor.
<BLOCKQUOTE><CODE>
Cursor: [<EM>column</EM>,<EM>row</EM>]
</CODE></BLOCKQUOTE>
</LI>
<LI>A line detailing the size of the selected screen region,
and the position (zero-origin) of its top-left corner.
<BLOCKQUOTE><CODE>
Region: <EM>width</EM>x<EM>height</EM>@[<EM>column</EM>,<EM>row</EM>]
</CODE></BLOCKQUOTE>
</LI>
<LI>The contents of the selected screen region.
Unprintable characters are written as blanks.</LI>
</OL>
<P>
<H3><A NAME="utility-tunetest"></A> tunetest</H3>

<P>This utility tests the alert tunes facility,
and also provides an easy way to compose new tunes.
<BLOCKQUOTE><CODE>
tunetest -<EM>option</EM> ... {<EM>note</EM> <EM>duration</EM>} ...
</CODE></BLOCKQUOTE>

<DL>
<DT><B><EM>note</EM></B><DD><P>A standard <CODE>MIDI</CODE> note number.
It must be an integer from <CODE>1</CODE> through <CODE>127</CODE>,
with <CODE>60</CODE> representing <CODE>Middle C</CODE>.
Each value represents a standard chromatic semi-tone,
with the next lower and higher values
representing, respectively, the next lower and higher notes.
The lowest value (<CODE>1</CODE>) represents
the fifth <CODE>C-Sharp</CODE> below <CODE>Middle C</CODE>,
and the highest value (<CODE>127</CODE>) represents
the sixth <CODE>G</CODE> above <CODE>Middle C</CODE>.
<DT><B><EM>duration</EM></B><DD><P>The duration of the note in milliseconds.
It must be an integer from <CODE>1</CODE> through <CODE>255</CODE>.
<DT><B><CODE>-d</CODE><EM>device</EM> <CODE>--device=</CODE><EM>device</EM></B><DD><P>The device on which to play the tune.
<DL>
<DT><B>speaker</B><DD><P>The built-in PC speaker.
<DT><B>dac</B><DD><P>The Digital to Analog Converter on the sound card.
<DT><B>midi</B><DD><P>The Musical Instrument Digital Interface on the sound card.
<DT><B>fm</B><DD><P>The FM synthesizer on an
AdLib, OPL3, Sound Blaster, or equivalent sound card.
</DL>

The device name may be abbreviated.
<DT><B><CODE>-i</CODE><EM>instrument</EM> <CODE>--instrument=</CODE><EM>instrument</EM></B><DD><P>The instrument to use if the selected device is <CODE>midi</CODE>.
For the complete list of instruments,
see the 
<A HREF="Manual-7.html#midi">MIDI Instrument Table</A>.
The default instrument is an <CODE>acoustic grand piano</CODE>.
The words comprising the instrument name must be separated from one another
by a single minus sign rather than by spaces,
and any of the words may be abbreviated.
An <CODE>acoustic grand piano</CODE>, for example, may be specified as <CODE>a-gra-pi</CODE>.
</DL>
<P>
<HR>
<A HREF="Manual-3.html">Next</A>
<A HREF="Manual-1.html">Previous</A>
<A HREF="Manual.html#toc2">Contents</A>
</BODY>
</HTML>
